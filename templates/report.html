{% extends 'layout.html' %}

{% block title %}Report{% endblock %}

{% block body %}

<script>
  window.onload = function() {
    document.getElementById('deleteLink').onclick = function() {
      var answer = confirm("Are you sure you wish to delete this report? Deleting this report would also delete any files associated with it.");
      if (answer) {
        window.location = "{{ url_for('delete_report', id=report['id']) }}";
      } else {
        return;
      }
    };
  };
</script>

<div class="container">
  <form action="" method="post">
    <input type="hidden" class="form-control" name="id" value="{{ report['id'] }}">
    <label>Name</label>
    <input type="text" class="form-control" name="name" placeholder="Report name" value="{{ report['name'] }}">
    <br>
    <label>Description</label>
    <textarea class="form-control" name="desc" placeholder="Report description">{{ report['desc'] }}</textarea>
    <br>
    <label>Uploaded By</label>
    <input disabled class="form-control" value="{{ report['creatid'] }}">
    <br>
    <label>Last Modified By</label>
    <input disabled class="form-control" value="{{ report['editid'] }}">
    <br>
    <label>Group</label>
    <select class="form-control" name="group">
      {% for group in groups %}
        <option value="{{ group.id }}"
          {% if report['group_id'] == group.id %}
            {{ 'selected' }}
          {% endif %}>
          {{ group.group_name }}
        </option>
      {% endfor %}
    </select>
    <br>
    <div class="panel panel-primary">
      <div class="panel-heading">
        <h3 class="panel-title">Files</h3>
      </div>
      {% for file in report['files'] %}
      <div class="panel-body">
        <a href="{{ url_for('download_file', id=file.id) }}">{{ file.name }}</a>
      </div>
      {% endfor %}
    </div>
    <br>
    <label>Tags</label>
    <table class="table table-striped table-bordered table-hover table-condensed">
      <tr>
        <th>Tag</th>
        <th>Add/Remove</th>
      </tr>
      {% for tag_id, tag_name, belongs_to in tags %}
        <tr>
          <td>{{ tag_name }}</td>
          <td><input type="checkbox" name=tags value="{{ tag_id }}"
              {% if belongs_to %}checked{% endif %}
            ></td>
        </tr>
      {% endfor %}
    </table>
    <br>
    <button type="submit" class="btn btn-default">Save</button>
  </form>
  <br>
  <a id="deleteLink" class="btn btn-danger" role="button">Delete</a>
</div>

{% endblock %}
